# node.js 基本架构

# node.js 是什么
  - 是一个运行在操作系统上的 JavaScript 运行时环境, 提供了一系列操作系统的 api.

# 文章生成工具
  - 输入标题
  - 读取语料库
  - 判断文字是否达标
    - 是: 生成文章
    - 否: 继续在语料库中选取内容, 直到达标. 

# HTTP
  - 标准的开放式互联网模型:
  1. 物理层
  2. 数据链路层
  3. 网络层: IP 协议, DNS 解析
  4. 传输层: TCP 协议
  5. 会话层
  6. 表示层
  7. 应用层: HTTP 协议(超文本传输协议)

- 使用 net 模块创建 TCP 服务, 用 TCP 服务来处理客户端的 HTTP 请求, 需要使用字符串模版来组织 http 请求和响应报文, 很麻烦
- 使用 http 模块创建 HTTP 服务, 更简便处理 http 请求

- 为什么 http 协议要分请求头和请求体?
  1. 为了内容协商 -- 根据不同的 accept 头,返回不同的内容
  <!-- 2. 为了支持 POST 方法 -- POST 方法的请求体可以是任意格式的, 而 GET 方法的请求参数只能是 key=value 格式的 -->

# 静态文件服务
  - 静态文件服务: 就是将文件直接返回给客户端, 不做任何处理.
  - 实现静态文件服务的步骤:
    1. 监听 HTTP 请求
    2. 解析请求路径
    3. 判断路径是否是文件
    4. 如果是文件, 读取文件内容
    5. 如果不是文件, 读取目录内容
    6. 返回文件内容或目录内容


# HTTP 缓存
- 强缓存
  - 浏览器会直接从缓存中读取资源, 不会向服务器发送请求.
  - 缓存时间: 浏览器会根据响应头中的 Cache-Control 或 Expires 头来判断缓存时间.
  - 缓存时间单位: 秒
  - 缓存时间示例:
    - Cache-Control: max-age=3600
    - Expires: Thu, 15 Apr 2023 20:00:00 GMT
  - 通过浏览器地址栏访问的资源, 会默认添加 Cache-Control: max-age=0 头, 表示不缓存.


- 协商缓存
  - 浏览器会向服务器发送请求, 询问资源是否有更新.
  - 缓存时间: 浏览器会根据响应头中的 Last-Modified 或 ETag 头来判断缓存时间.
  - 缓存时间单位: 秒
  - 缓存时间示例:
    - Last-Modified: Thu, 15 Apr 2023 20:00:00 GMT
    - ETag: "1234567890"
  - 协商缓存的工作流程:
    1. 浏览器第一次请求资源, 服务器返回资源, 并在响应头中添加 Last-Modified 或 ETag 头.
    2. 浏览器第二次请求资源, 会在请求头中添加 If-Modified-Since 或 If-None-Match 头, 头的值就是上一次返回的 Last-Modified 或 ETag 值.
    3. 服务器收到请求, 会根据请求头中的 If-Modified-Since 或 If-None-Match 头, 来判断资源是否有更新.
